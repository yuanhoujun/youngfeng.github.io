---
title: 是时候跟Dagger2说再见了！
date: 2019-12-06 19:17:25
tags:
- DI
- 依赖注入
categories:
- Android
- 计算机基础
---

> Dagger2是一个设计精良并且性能优越的DI（依赖注入）开源库，Google团队出品，其Fork自Square团队的Dagger库。自开源以来，基本已经成为了Android端依赖注入事实上的标准。但作为一个Java后端程序员出身的我，相对于Spring，Dagger2简直难用至极。为了实现相对较为复杂的依赖注入，你需要完成一堆配置。每一个技术都是为了解决一个问题，DI只不过是为了解决new的问题而已。很显然，使用Dagger，有点得不偿失。是否有一个更好的DI库可以替代Dagger呢，从Kotlin的DSL身上我们似乎看到了另外一种可能。今天，我给大家安利一个同样设计精良，使用Kotlin的DSL特性完成依赖注入的开源库，这个开源库目前正处于高速发展之中，强烈推荐大家使用。

<!-- more -->

### 依赖注入基础知识

上面说到，依赖注入解决的问题很简单，就是为了解决new的问题。我们知道，在Java语言中，为了创建一个对象，必须使用new关键字，如果这个对象不需要依赖任何其他对象，使用new类名就可以完成轻松创建了。而如果某个对象同时依赖多个对象，除了使用new完成目标对象创建之外，还要同时创建其他依赖对象，并且将这些依赖“注入”到目标对象中，这是一个繁琐且需要不断重复的过程，需要大量的样板代码。为了减少不断重复的样板式代码，有人提出了依赖注入的概念。

事实上，关于依赖注入的问题，上面我们仅仅提到了最常见的部分。在实际开发场景中，一个完整的DI框架还需要解决以下几个问题：

* 生成单例对象
* 生成一定范围生效的对象
* 可以自定义销毁对象
...


单例是我们开发中经常用到的一种对象类型，为了使对象复用，减少不必要的内存损耗，我们经常会使用单例创建对象。而在Java语言中，为了创建单例对象，不仅需要使用同步代码块，还需要DC（Double Check），这实在是一个繁琐的过程。作为DI框架，当然也要解决这个问题。

### Scope
关于Scope，我必须要重点提一下，这是一个相对比较难理解的概念。为了便于大家的理解，我们先来看一张图：


